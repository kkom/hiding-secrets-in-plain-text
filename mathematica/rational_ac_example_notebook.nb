Notebook[{

Cell[CellGroupData[{
Cell["Simple infinite precision arithmetic encoder", "Title",
 CellChangeTimes->{{3.59057184602109*^9, 3.590571858147958*^9}}],

Cell["\<\
This is a simple, proof-of-concept arithmetic encoder operating on rational \
intervals. The encoder assumes an i.i.d. distrubution of the source alphabet.\
\
\>", "Text",
 CellChangeTimes->{{3.5905719296787777`*^9, 3.5905720305928698`*^9}}],

Cell[CellGroupData[{

Cell["Source alphabet and distribution", "Subsection",
 CellChangeTimes->{{3.590571984254033*^9, 3.590571994716408*^9}, {
   3.590572034944631*^9, 3.59057205693365*^9}, {3.5905722142847967`*^9, 
   3.5905722180604677`*^9}, 3.5905726079930162`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"alphabet", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<C\>\"", ",", "\"\<D\>\"", ",", 
     "\"\<E\>\"", ",", "\"\<F\>\"", ",", "\"\<G\>\"", ",", "\"\<H\>\"", ",", 
     "\"\<I\>\"", ",", "\"\<J\>\"", ",", "\"\<K\>\"", ",", "\"\<L\>\"", ",", 
     "\"\<M\>\"", ",", "\"\<N\>\"", ",", "\"\<O\>\"", ",", "\"\<P\>\"", ",", 
     "\"\<Q\>\"", ",", "\"\<R\>\"", ",", "\"\<S\>\"", ",", "\"\<T\>\"", ",", 
     "\"\<U\>\"", ",", "\"\<V\>\"", ",", "\"\<W\>\"", ",", "\"\<X\>\"", ",", 
     "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\< \>\"", ",", "\"\<.\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"relativeFrequencies", "=", 
    RowBox[{"{", 
     RowBox[{
     "653", ",", "125", ",", "223", ",", "328", ",", "1026", ",", "198", ",", 
      "162", ",", "497", ",", "566", ",", "9", ",", "56", ",", "331", ",", 
      "202", ",", "571", ",", "615", ",", "150", ",", "8", ",", "498", ",", 
      "531", ",", "751", ",", "227", ",", "79", ",", "170", ",", "14", ",", 
      "142", ",", "5", ",", "1828", ",", "100"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "mapping", " ", "from", " ", "an", " ", "index", " ", "to", " ", 
    "actual", " ", "letter"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"l", "[", "i", "]"}], "=", 
    RowBox[{"alphabet", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "mapping", " ", "from", " ", "an", " ", "actual", " ", "letter", 
    " ", "to", " ", "an", " ", "index"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"i", "[", "\"\<A\>\"", "]"}], "=", "1"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<B\>\"", "]"}], "=", "2"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<C\>\"", "]"}], "=", "3"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<D\>\"", "]"}], "=", "4"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<E\>\"", "]"}], "=", "5"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<F\>\"", "]"}], "=", "6"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<G\>\"", "]"}], "=", "7"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<H\>\"", "]"}], "=", "8"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<I\>\"", "]"}], "=", "9"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<J\>\"", "]"}], "=", "10"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<K\>\"", "]"}], "=", "11"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<L\>\"", "]"}], "=", "12"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<M\>\"", "]"}], "=", "13"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<N\>\"", "]"}], "=", "14"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<O\>\"", "]"}], "=", "15"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<P\>\"", "]"}], "=", "16"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<Q\>\"", "]"}], "=", "17"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<R\>\"", "]"}], "=", "18"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<S\>\"", "]"}], "=", "19"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<T\>\"", "]"}], "=", "20"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<U\>\"", "]"}], "=", "21"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<V\>\"", "]"}], "=", "22"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<W\>\"", "]"}], "=", "23"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<X\>\"", "]"}], "=", "24"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<Y\>\"", "]"}], "=", "25"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<Z\>\"", "]"}], "=", "26"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\< \>\"", "]"}], "=", "27"}], ";", 
   RowBox[{
    RowBox[{"i", "[", "\"\<.\>\"", "]"}], "=", "28"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "only", " ", "\"\<.\>\"", " ", "is", " ", "a", " ", "stop", " ", 
    "symbol"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isStop", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"isStop", "[", "i", "]"}], "=", 
    RowBox[{
     RowBox[{"alphabet", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<.\>\""}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "probabilities", " ", "of", " ", "different", " ", "symbols", 
    " ", "as", " ", "rational", " ", "numbers"}], " ", 
   "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "m_", "]"}], ":=", 
   RowBox[{
    RowBox[{"p", "[", "m", "]"}], "=", 
    RowBox[{
     RowBox[{"relativeFrequencies", "[", 
      RowBox[{"[", "m", "]"}], "]"}], "/", 
     RowBox[{"Total", "[", "relativeFrequencies", "]"}]}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "cumulative", " ", "probabilities", " ", "of", " ", "different", 
    " ", "symbols"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "1", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "[", "m_", "]"}], ":=", 
  RowBox[{
   RowBox[{"c", "[", "m", "]"}], "=", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"m", "-", "1"}], "]"}], "+", 
    RowBox[{"p", "[", 
     RowBox[{"m", "-", "1"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.590559065864923*^9, 3.590559066855343*^9}, {
   3.590559431651634*^9, 3.5905595152028418`*^9}, {3.590559635087957*^9, 
   3.590559755212348*^9}, {3.5905678828255033`*^9, 3.590567893022406*^9}, {
   3.590567977451941*^9, 3.590568064398344*^9}, {3.590568098270447*^9, 
   3.590568098515439*^9}, {3.590568238925357*^9, 3.5905682450565853`*^9}, {
   3.590568289764958*^9, 3.59056832592452*^9}, {3.5905694233416233`*^9, 
   3.59056944125994*^9}, {3.590569794187376*^9, 3.5905697982466497`*^9}, {
   3.5905720846009912`*^9, 3.590572112860613*^9}, {3.590572813069975*^9, 
   3.590572830865121*^9}, {3.590579461612925*^9, 3.590579475320285*^9}, {
   3.5905795657552147`*^9, 3.5905795885189247`*^9}, {3.5905796246016912`*^9, 
   3.590579635526455*^9}, {3.5905796701740522`*^9, 3.5905796730527143`*^9}, 
   3.590579902900823*^9, 3.5905799791818457`*^9, 3.5905806247960253`*^9, 
   3.590580675340125*^9, {3.5905813465581512`*^9, 3.59058143453484*^9}, {
   3.5905815012178288`*^9, 3.590581514296562*^9}, {3.590581645043653*^9, 
   3.590581656671357*^9}, {3.590581809842607*^9, 3.5905818126203213`*^9}, {
   3.5905818976501837`*^9, 3.590581901749453*^9}, {3.590581953124754*^9, 
   3.590582008899971*^9}, {3.5905820740274763`*^9, 3.590582080665168*^9}, {
   3.5905823583564262`*^9, 3.590582375043623*^9}, {3.5905824191798477`*^9, 
   3.590582419777466*^9}, {3.5905826126715727`*^9, 3.590582642969768*^9}, {
   3.590582690166314*^9, 3.590582701017304*^9}, {3.5905827569988213`*^9, 
   3.5905828020783653`*^9}, {3.5906501062105923`*^9, 3.590650108484602*^9}, {
   3.590650340930849*^9, 3.590650443311491*^9}, {3.590654478591755*^9, 
   3.590654478888432*^9}, {3.5906553482157*^9, 3.590655417663196*^9}, {
   3.590655925154944*^9, 3.5906559273741827`*^9}, 3.590656615860319*^9, {
   3.590657643696437*^9, 3.590657744693152*^9}, {3.590657850532611*^9, 
   3.590657858067093*^9}, {3.5908217334583387`*^9, 3.5908217636689577`*^9}, {
   3.5908233396737137`*^9, 3.5908233637763567`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Recursive definition of an arithmetic encoder \[CapitalPhi]\
\>", "Subsection",
 CellChangeTimes->{{3.590572252062242*^9, 3.590572265689403*^9}, {
  3.5906578797173986`*^9, 3.590657890650076*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"{", "}"}], "]"}], "=", 
   RowBox[{"(", GridBox[{
      {"0"},
      {"1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPhi]", "[", "S_", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", "S", "]"}], "=", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{"c", "[", 
         RowBox[{"Last", "[", "S", "]"}], "]"}]},
       {"0", 
        RowBox[{"p", "[", 
         RowBox[{"Last", "[", "S", "]"}], "]"}]}
      }], ")"}], ".", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"Drop", "[", 
      RowBox[{"S", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.59055916555103*^9, 3.59055924891903*^9}, 
   3.5905592930811367`*^9, 3.590559353174876*^9, 3.590559383947609*^9, {
   3.590559413953567*^9, 3.590559418913067*^9}, {3.5905683989290457`*^9, 
   3.5905684556047297`*^9}, {3.590568569206326*^9, 3.590568622480363*^9}, {
   3.590568656815649*^9, 3.590568659462125*^9}, {3.590568893171628*^9, 
   3.590568989033594*^9}, 3.590569019943668*^9, {3.590569284520256*^9, 
   3.590569317733251*^9}, {3.590569795664301*^9, 3.590569796425028*^9}, {
   3.5905724023712254`*^9, 3.590572406246387*^9}, {3.590582938180633*^9, 
   3.590582945431919*^9}, {3.590647359744844*^9, 3.59064737729704*^9}, {
   3.5906474103658533`*^9, 3.5906474442899303`*^9}, {3.590648306821559*^9, 
   3.590648368847601*^9}, {3.5906498858005257`*^9, 3.5906499060032988`*^9}, {
   3.590654477243971*^9, 3.5906544863358803`*^9}, {3.5906566855270567`*^9, 
   3.590656699276268*^9}, {3.5906567477372217`*^9, 3.590656761124186*^9}, {
   3.592226104119721*^9, 3.592226104509129*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Recursive definition of an arithmetic decoder \[CapitalPsi]\
\>", "Subsection",
 CellChangeTimes->{{3.590572252062242*^9, 3.590572265689403*^9}, {
  3.590654524754602*^9, 3.5906545251103067`*^9}, {3.59065789719158*^9, 
  3.590657897477395*^9}}],

Cell["\<\
Decoder \[Psi] given a fraction v returns the codeword it corresponds to in \
the full interval [0,1).
Decoder \[CapitalPsi] recursively decodes the full sequence from an input \
fraction v, stopping when it reaches a stop character.\
\>", "Text",
 CellChangeTimes->{{3.5908219641494713`*^9, 3.59082205007679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "this", " ", "can", " ", "be", " ", "improved", " ", "to", " ", 
    "run", " ", "in", " ", "O", 
    RowBox[{"(", 
     RowBox[{"log", " ", "n"}], ")"}], " ", "instead", " ", "of", " ", "O", 
    RowBox[{"(", "n", ")"}], " ", "time", " ", "by", " ", "using", " ", 
    "binary", " ", "instead", " ", "of", " ", "incremental", " ", "search"}], 
   " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]", "[", "v_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Psi]", "[", "v", "]"}], "=", 
     RowBox[{"First", "[", 
      RowBox[{"Select", "[", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "alphabet", "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "*", " ", "for", " ", "all", " ", "symbol", " ", "indices", " ", 
          "#1", " ", "starting", " ", "from", " ", "1"}], " ", "**)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"v", "<", 
          RowBox[{"c", "[", 
           RowBox[{"#1", "+", "1"}], "]"}]}], "&"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "*", " ", "select", " ", "those", " ", "for", " ", "which", " ", 
           "v"}], "<", 
          RowBox[{"c", "[", 
           RowBox[{"#1", "+", "1"}], "]"}]}], " ", "**)"}], 
        "\[IndentingNewLine]", "1"}], " ", 
       RowBox[{"(*", 
        RowBox[{
        "*", " ", "choose", " ", "only", " ", "the", " ", "first", " ", 
         "match"}], " ", "**)"}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalPsi]", "[", "v_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", "v", "]"}], "=", 
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Psi]", "[", "v", "]"}], "}"}], ",", 
       FractionBox[
        RowBox[{"v", "-", 
         RowBox[{"c", "[", 
          RowBox[{"\[Psi]", "[", "v", "]"}], "]"}]}], 
        RowBox[{"p", "[", 
         RowBox[{"\[Psi]", "[", "v", "]"}], "]"}]]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalPsi]", "[", 
     RowBox[{"S_", ",", "v_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{"S", ",", "v"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"isStop", "[", 
        RowBox[{"Last", "[", "S", "]"}], "]"}], ",", "S", ",", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"S", ",", 
           RowBox[{"\[Psi]", "[", "v", "]"}]}], "]"}], ",", 
         FractionBox[
          RowBox[{"v", "-", 
           RowBox[{"c", "[", 
            RowBox[{"\[Psi]", "[", "v", "]"}], "]"}]}], 
          RowBox[{"p", "[", 
           RowBox[{"\[Psi]", "[", "v", "]"}], "]"}]]}], "]"}]}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.59055916555103*^9, 3.59055924891903*^9}, 
   3.5905592930811367`*^9, 3.590559353174876*^9, 3.590559383947609*^9, {
   3.590559413953567*^9, 3.590559418913067*^9}, {3.5905683989290457`*^9, 
   3.5905684556047297`*^9}, {3.590568569206326*^9, 3.590568622480363*^9}, {
   3.590568656815649*^9, 3.590568659462125*^9}, {3.590568893171628*^9, 
   3.590568989033594*^9}, 3.590569019943668*^9, {3.590569284520256*^9, 
   3.590569317733251*^9}, {3.590569795664301*^9, 3.590569796425028*^9}, {
   3.5905724023712254`*^9, 3.590572406246387*^9}, {3.590582938180633*^9, 
   3.590582945431919*^9}, {3.590647359744844*^9, 3.59064737729704*^9}, {
   3.5906474103658533`*^9, 3.5906474442899303`*^9}, {3.590648306821559*^9, 
   3.590648368847601*^9}, {3.5906498858005257`*^9, 3.5906499060032988`*^9}, {
   3.590654477243971*^9, 3.5906544863358803`*^9}, {3.5906548187307863`*^9, 
   3.590654886932221*^9}, {3.590654962079698*^9, 3.590654968534758*^9}, {
   3.5906551596608953`*^9, 3.5906551963660393`*^9}, {3.590655321523971*^9, 
   3.5906553217980833`*^9}, {3.5906554469878607`*^9, 3.590655600219838*^9}, {
   3.590655770259355*^9, 3.590655836267662*^9}, {3.590655875483489*^9, 
   3.590655880657675*^9}, {3.590655949540346*^9, 3.590655977112615*^9}, {
   3.590656023835552*^9, 3.590656058489024*^9}, {3.590656132861225*^9, 
   3.5906562423918123`*^9}, {3.590656351763397*^9, 3.590656373612604*^9}, {
   3.590656427966255*^9, 3.590656450592157*^9}, {3.59065652880836*^9, 
   3.59065653978344*^9}, {3.590656703610044*^9, 3.590656708743067*^9}, {
   3.590656779164954*^9, 3.5906568212299547`*^9}, {3.5906568952773542`*^9, 
   3.5906570046433687`*^9}, {3.5906570508927727`*^9, 3.590657124508997*^9}, {
   3.590657861546274*^9, 3.590657869881328*^9}, {3.5906596104540243`*^9, 
   3.5906596256618147`*^9}, {3.590659710866695*^9, 3.590659716719091*^9}, {
   3.59066048079099*^9, 3.5906605085565767`*^9}, 3.5908216430870457`*^9, {
   3.590821846775424*^9, 3.5908219458779783`*^9}, {3.5908230948963823`*^9, 
   3.5908231343081903`*^9}, {3.590823310419676*^9, 3.5908233157232103`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Encoding and decoding an example arbitrary source sequence", \
"Subsection",
 CellChangeTimes->{{3.590572677299274*^9, 3.590572687284896*^9}, {
  3.590657243773329*^9, 3.590657247212674*^9}, {3.59065790993445*^9, 
  3.590657915274577*^9}}],

Cell["\<\
I\[CloseCurlyQuote]m using a Module to avoid unnecesarily setting global \
variables. \
\>", "Text",
 CellChangeTimes->{{3.590823166005509*^9, 3.590823178852015*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"string", ",", "S", ",", "\[Zeta]", ",", 
     RowBox[{"N", "=", "5000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "finish", " ", "the", " ", "sentence", " ", "with", " ", "a", 
     " ", "dot", " ", "so", " ", "that", " ", "the", " ", "decoder", " ", 
     "knows", " ", "when", " ", "to", " ", "stop", " ", "decoding"}], " ", 
    "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{"string", "=", "\"\<HELLO WORLD.\>\""}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "map", " ", "the", " ", "sequence", " ", "of", " ", 
      "characters", " ", "in", " ", "the", " ", "string", " ", "onto", " ", 
      "a", " ", "sequence", " ", "of", " ", "codeword", " ", "indices"}], " ",
      "**)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"i", ",", 
        RowBox[{"Characters", "[", "string", "]"}]}], "]"}]}], " ", 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "encode", " ", "and", " ", "time", " ", "it"}], " ", 
     "**)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{"Timing", "[", 
      RowBox[{"\[CapitalPhi]", "[", "S", "]"}], "]"}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "arbitrarily", " ", "choose", " ", "beginning", " ", "of", " ",
       "the", " ", "interval", " ", "as", " ", "the", " ", "code", " ", 
      "fraction", " ", "\[Zeta]"}], " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Zeta]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "S", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "decode", " ", "and", " ", "time", " ", "it"}], " ", 
     "**)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{"Timing", "[", 
      RowBox[{"\[CapitalPsi]", "[", "\[Zeta]", "]"}], "]"}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "map", " ", "the", " ", "encoded", " ", "sequence", " ", 
      "back", " ", "onto", " ", "a", " ", "string"}], " ", "**)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"l", ",", 
        RowBox[{"\[CapitalPsi]", "[", "\[Zeta]", "]"}]}], "]"}], "]"}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "verify", " ", "that", " ", "the", " ", "input", " ", "and", 
      " ", "decoded", " ", "sequences", " ", "are", " ", "the", " ", "same"}],
      " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{"S", "\[Equal]", 
     RowBox[{"\[CapitalPsi]", "[", "\[Zeta]", "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.590568210309125*^9, 3.590568235496546*^9}, {
   3.590568320659894*^9, 3.590568386751408*^9}, {3.590568459587027*^9, 
   3.5905684599139767`*^9}, {3.590568577015108*^9, 3.590568578520935*^9}, {
   3.590568938252569*^9, 3.590568945762741*^9}, {3.590569320394552*^9, 
   3.590569353648728*^9}, {3.5905693836874933`*^9, 3.5905694182039423`*^9}, {
   3.590569457812392*^9, 3.59056945967328*^9}, {3.5905695734560337`*^9, 
   3.590569591396418*^9}, {3.590569636213022*^9, 3.590569659048348*^9}, {
   3.590569803950098*^9, 3.590569822915023*^9}, {3.590569910668281*^9, 
   3.5905699116901197`*^9}, 3.5905723275143023`*^9, {3.59057257174183*^9, 
   3.590572574232914*^9}, {3.590572694368403*^9, 3.590572728020824*^9}, 
   3.590572835319738*^9, {3.59057969376674*^9, 3.590579716627695*^9}, {
   3.590579749643465*^9, 3.590579765239685*^9}, {3.590580685449102*^9, 
   3.590580703398164*^9}, 3.5905821710716877`*^9, 3.590582267293984*^9, {
   3.590582430167235*^9, 3.590582441530485*^9}, {3.590582516677658*^9, 
   3.590582533646256*^9}, 3.5905828084607487`*^9, {3.590582985217207*^9, 
   3.5905829934674263`*^9}, {3.590583047275025*^9, 3.590583050336526*^9}, {
   3.5905831150993843`*^9, 3.590583151426065*^9}, {3.590583215192079*^9, 
   3.590583216326041*^9}, {3.590583569857945*^9, 3.590583571559188*^9}, 
   3.590584006925035*^9, {3.590584050122942*^9, 3.590584083679164*^9}, {
   3.59064811052054*^9, 3.590648110982415*^9}, {3.59065156600462*^9, 
   3.5906515687898407`*^9}, {3.590651719753841*^9, 3.590651721025634*^9}, 
   3.590651755397661*^9, 3.590651800659287*^9, {3.590651863298045*^9, 
   3.590651878920905*^9}, {3.5906519426845818`*^9, 3.590651942830861*^9}, {
   3.590652103804422*^9, 3.590652115747807*^9}, {3.5906521499403152`*^9, 
   3.590652163215831*^9}, 3.590652415248999*^9, {3.5906526929762897`*^9, 
   3.590652704470501*^9}, {3.590655228395628*^9, 3.590655246098998*^9}, {
   3.590655287960681*^9, 3.590655291921773*^9}, {3.5906564675884*^9, 
   3.590656521002804*^9}, {3.590656716871523*^9, 3.590656722560972*^9}, {
   3.59065683041642*^9, 3.590656837913479*^9}, {3.590657281158505*^9, 
   3.5906573009450493`*^9}, {3.590657454718658*^9, 3.590657504233179*^9}, {
   3.590657795837338*^9, 3.5906578475881557`*^9}, {3.59065899305175*^9, 
   3.590659013983007*^9}, 3.5906611227076178`*^9, {3.590670101107542*^9, 
   3.5906701019006767`*^9}, {3.5907478732649593`*^9, 3.590747877796791*^9}, {
   3.590759048891514*^9, 3.590759058526018*^9}, 3.590820119782892*^9, 
   3.5908216692542067`*^9, {3.5908221047918577`*^9, 3.590822109168002*^9}, {
   3.590822251646392*^9, 3.590822340310107*^9}, {3.5908228515901937`*^9, 
   3.5908229940188847`*^9}, {3.590823147917921*^9, 3.5908231500401497`*^9}, {
   3.590823208905074*^9, 3.59082326777584*^9}, 3.5908287034681273`*^9, {
   3.5916942982053547`*^9, 3.591694299887866*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Encoding and decoding a long, random source sequence", "Subsection",
 CellChangeTimes->{{3.590572677299274*^9, 3.590572687284896*^9}, {
  3.590657243773329*^9, 3.590657247212674*^9}, {3.590657314052191*^9, 
  3.590657318100663*^9}}],

Cell["\<\
Although the probability distribution of symbols used in the coding process \
is the true English language distribution, here we use a uniform distribution \
to generate the input sequence.\
\>", "Text",
 CellChangeTimes->{{3.590657943828538*^9, 3.5906579819822598`*^9}, {
  3.590658070062271*^9, 3.590658075368299*^9}, {3.591694337819748*^9, 
  3.591694379096208*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"$RecursionLimit", "=", "10000"}], ",", "S", ",", "\[Zeta]", ",", 
     RowBox[{"N", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", " ", "generate", " ", "a", " ", "random", " ", "sequence", " ", 
     "and", " ", "finish", " ", "it", " ", "with", " ", "a", " ", "dot"}], 
    " ", "**)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "alphabet", "]"}], "-", "1"}]}], "}"}], 
         ",", "N"}], "]"}], ",", 
       RowBox[{"i", "[", "\"\<.\>\"", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "encode", " ", "and", " ", "time", " ", "it"}], " ", 
     "**)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{"Timing", "[", 
      RowBox[{"\[CapitalPhi]", "[", "S", "]"}], "]"}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "arbitrarily", " ", "choose", " ", "beginning", " ", "of", " ",
       "the", " ", "interval", " ", "as", " ", "the", " ", "code", " ", 
      "fraction", " ", "\[Zeta]"}], " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Zeta]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "S", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "just", " ", "display", " ", "the", " ", "time", " ", "taken", 
      " ", "to", " ", "decode", " ", "the", " ", "sequence"}], " ", "**)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Timing", "[", 
       RowBox[{"\[CapitalPsi]", "[", "\[Zeta]", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "verify", " ", "that", " ", "the", " ", "input", " ", "and", 
      " ", "decoded", " ", "sequences", " ", "are", " ", "the", " ", "same"}],
      " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{"S", "\[Equal]", 
     RowBox[{"\[CapitalPsi]", "[", "\[Zeta]", "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.590657321383267*^9, 3.5906573929495*^9}, {
   3.590657424245737*^9, 3.5906574470522957`*^9}, {3.590657520788821*^9, 
   3.590657531456163*^9}, {3.590657576953003*^9, 3.590657583086555*^9}, {
   3.590657842030143*^9, 3.5906578442039213`*^9}, {3.5906585082286863`*^9, 
   3.590658551475655*^9}, 3.5906641679858932`*^9, {3.5908221498965816`*^9, 
   3.590822201470738*^9}, {3.5908223462578897`*^9, 3.590822394122179*^9}, {
   3.590822432952816*^9, 3.590822714867133*^9}, {3.590822777983513*^9, 
   3.59082281423667*^9}, {3.590823271730122*^9, 3.590823273814501*^9}, {
   3.592226141874468*^9, 3.592226142106327*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1308, 724},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]

