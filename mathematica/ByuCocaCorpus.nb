Notebook[{

Cell[CellGroupData[{
Cell["BYU COCA corpus", "Title"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<ByuCocaCorpus`\>\"", ",", 
    RowBox[{"{", "\"\<DatabaseLink`\>\"", "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ByuCocaPQuery", "::", "usage"}], "=", 
  "\"\<Later\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ByuCocaC1Query", "::", "usage"}], "=", 
  "\"\<Later\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ByuCocaC2Query", "::", "usage"}], "=", 
  "\"\<Later\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ByuCocaSuperintervalQuery", "::", "usage"}], "=", 
   "\"\<Later\>\""}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"genConnection", "[", 
     RowBox[{"host_", ",", "credentials_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"genConnection", "[", 
      RowBox[{"host", ",", "credentials"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"OpenSQLConnection", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"JDBC", "[", 
        RowBox[{"\"\<PostgreSQL\>\"", ",", "host"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Username\>\"", "\[Rule]", 
        RowBox[{"First", "[", "credentials", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Password\>\"", "\[Rule]", 
        RowBox[{"Last", "[", "credentials", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"genTableName", "[", 
     RowBox[{"dataset_", ",", "fullN_", ",", "n_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"genTableName", "[", 
      RowBox[{"dataset", ",", "fullN", ",", "n"}], "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<byu_coca_corpus.\>\"", "<>", "\[IndentingNewLine]", "\"\<\\\"\>\"", 
      "<>", 
      RowBox[{"ToString", "[", "fullN", "]"}], "<>", "\"\<gram_\>\"", "<>", 
      "dataset", "<>", "\[IndentingNewLine]", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<\\\"\>\""}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"genColumnNames", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"genColumnNames", "[", "n", "]"}], "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<w\>\"", "<>", 
         RowBox[{"ToString", "[", "#1", "]"}]}], "&"}], ",", 
       RowBox[{"Range", "[", "n", "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"selectRows", "[", 
     RowBox[{
     "conn_", ",", "table_", ",", "cols_", ",", "cFuns_", ",", "cCols_", ",", 
      "cVals_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"selectRows", "[", 
      RowBox[{
      "conn", ",", "table", ",", "cols", ",", "cFuns", ",", "cCols", ",", 
       "cVals"}], "]"}], "=", "\[IndentingNewLine]", 
     RowBox[{"SQLSelect", "[", "\[IndentingNewLine]", 
      RowBox[{
      "conn", ",", "\[IndentingNewLine]", "table", ",", "\[IndentingNewLine]",
        "cols", ",", "\[IndentingNewLine]", 
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", " ", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{
              RowBox[{"SQLColumn", "[", "#2", "]"}], ",", "#3"}], "]"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"cFuns", ",", "cCols", ",", "cVals"}], "}"}]}], "]"}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"selectSequenceStatRow", "[", 
     RowBox[{"conn_", ",", "dataset_", ",", "fullN_", ",", "S_"}], "]"}], ":=", 
    RowBox[{"selectRows", "[", "\[IndentingNewLine]", 
     RowBox[{"conn", ",", "\[IndentingNewLine]", 
      RowBox[{"genTableName", "[", 
       RowBox[{"dataset", ",", "fullN", ",", 
        RowBox[{"Length", "[", "S", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\"\<p\>\"", ",", "\"\<c1\>\"", ",", "\"\<c2\>\""}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{"Equal", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "S", "]"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"genColumnNames", "[", 
       RowBox[{"Length", "[", "S", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      "S"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSequenceStat", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "_"}], "]"}], ":=", 
   RowBox[{"Throw", "[", "\"\<Sequence doesn't exist.\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getSequenceStat", "[", 
     RowBox[{"rows_List", ",", "i_"}], "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "rows", "]"}], "\[Equal]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", "rows", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "Throw", "[", 
       "\"\<Fetched more than one row corresponding to a sequence.\>\"", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cutSequences", "[", 
     RowBox[{"s_", ",", "S_", ",", "fullN_", ","}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{"s", ",", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Length", "[", "s", "]"}], ",", "fullN"}], "]"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Take", "[", 
       RowBox[{"S", ",", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Length", "[", "S", "]"}], ",", 
           RowBox[{"fullN", "-", 
            RowBox[{"Length", "[", "s", "]"}]}]}], "]"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeList", "[", "x_List", "]"}], ":=", "x"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeList", "[", "x_", "]"}], ":=", 
    RowBox[{"{", "x", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", 
     RowBox[{"conn_", ",", "dataset_", ",", "fullN_", ",", "s_", ",", "S_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sCut", ",", "SCut"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sCut", ",", "SCut"}], "}"}], "=", 
        RowBox[{"cutSequences", "[", 
         RowBox[{
          RowBox[{"makeList", "[", "s", "]"}], ",", 
          RowBox[{"makeList", "[", "S", "]"}], ",", "fullN"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       FractionBox[
        RowBox[{"getSequenceStat", "[", 
         RowBox[{
          RowBox[{"selectSequenceStatRow", "[", 
           RowBox[{"conn", ",", "dataset", ",", "fullN", ",", 
            RowBox[{"Join", "[", 
             RowBox[{"SCut", ",", "sCut"}], "]"}]}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"getSequenceStat", "[", 
         RowBox[{
          RowBox[{"selectSequenceStatRow", "[", 
           RowBox[{"conn", ",", "dataset", ",", "fullN", ",", "SCut"}], "]"}],
           ",", "1"}], "]"}]]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{
     "conn_", ",", "dataset_", ",", "fullN_", ",", "s_", ",", "S_", ",", 
      "cIndex_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sCut", ",", "SCut", ",", "C1", ",", "P", ",", "c"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sCut", ",", "SCut"}], "}"}], "=", 
        RowBox[{"cutSequences", "[", 
         RowBox[{
          RowBox[{"makeList", "[", "s", "]"}], ",", 
          RowBox[{"makeList", "[", "S", "]"}], ",", "fullN"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"P", ",", "C1"}], "}"}], "=", 
        RowBox[{"getSequenceStat", "[", 
         RowBox[{
          RowBox[{"selectSequenceStatRow", "[", 
           RowBox[{"conn", ",", "dataset", ",", "fullN", ",", "SCut"}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"getSequenceStat", "[", 
         RowBox[{
          RowBox[{"selectSequenceStatRow", "[", 
           RowBox[{"conn", ",", "dataset", ",", "fullN", ",", 
            RowBox[{"Join", "[", 
             RowBox[{"SCut", ",", "sCut"}], "]"}]}], "]"}], ",", 
          RowBox[{"cIndex", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       FractionBox[
        RowBox[{"c", "-", "C1"}], "P"]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getWord", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "Null"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getWord", "[", "rows_List", "]"}], ":=", 
    RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "10", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RandomChoice", "[", "rows", "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"getWord", "[", "rows_List", "]"}], ":=", 
     RowBox[{"First", "[", 
      RowBox[{"RandomChoice", "[", "rows", "]"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getSuperinterval", "[", 
     RowBox[{"conn_", ",", "table_", ",", "col_", ",", "c1_", ",", "c2_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"getWord", "[", 
     RowBox[{"selectRows", "[", "\[IndentingNewLine]", 
      RowBox[{"conn", ",", "table", ",", "col", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"LessEqual", ",", "GreaterEqual"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<c1\>\"", ",", "\"\<c2\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "c2"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getSubinterval", "[", 
     RowBox[{"conn_", ",", "table_", ",", "col_", ",", "c1_", ",", "c2_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"getWord", "[", 
     RowBox[{"selectRows", "[", "\[IndentingNewLine]", 
      RowBox[{"conn", ",", "table", ",", "col", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"GreaterEqual", ",", "LessEqual"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<c1\>\"", ",", "\"\<c2\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "c2"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getPreinterval", "[", 
     RowBox[{"conn_", ",", "table_", ",", "col_", ",", "c1_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"selectRows", "[", "\[IndentingNewLine]", 
      RowBox[{"conn", ",", "table", ",", 
       RowBox[{"{", 
        RowBox[{"col", ",", "\"\<c2\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"LessEqual", ",", "GreaterEqual"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<c1\>\"", ",", "\"\<c2\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "c1"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getPostinterval", "[", 
     RowBox[{"conn_", ",", "table_", ",", "col_", ",", "c2_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"selectRows", "[", "\[IndentingNewLine]", 
      RowBox[{"conn", ",", "table", ",", 
       RowBox[{"{", 
        RowBox[{"col", ",", "\"\<c1\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"LessEqual", ",", "GreaterEqual"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<c1\>\"", ",", "\"\<c2\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "c2"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkPrevious", "[", 
    RowBox[{"conn_", ",", "dataset_", ",", "fullN_", ",", "SCut_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"checkPrevious", "[", 
    RowBox[{"conn", ",", "dataset", ",", "fullN", ",", "SCut", ",", 
     RowBox[{"selectSequenceStatRow", "[", 
      RowBox[{"conn", ",", "dataset", ",", "fullN", ",", "SCut"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkPrevious", "[", 
    RowBox[{"conn_", ",", "dataset_", ",", "fullN_", ",", "SCut_", ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"checkPrevious", "[", 
    RowBox[{"conn", ",", "dataset", ",", "fullN", ",", 
     RowBox[{"Rest", "[", "SCut", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkPrevious", "[", 
     RowBox[{
     "conn_", ",", "dataset_", ",", "fullN_", ",", "SCut_", ",", "result_"}], 
     "]"}], ":=", "result"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"conn_", ",", "dataset_", ",", "fullN_", ",", "v_", ",", "S_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "table", ",", "col", ",", "SCut", ",", "P", ",", "C1", ",", "c1", ",", 
       "c2", ",", "s", ",", "statRow"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SCut", "=", 
       RowBox[{"Take", "[", 
        RowBox[{"S", ",", 
         RowBox[{"-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Length", "[", "S", "]"}], ",", 
            RowBox[{"fullN", "-", "1"}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"table", "=", 
       RowBox[{"genTableName", "[", 
        RowBox[{"dataset", ",", "fullN", ",", 
         RowBox[{
          RowBox[{"Length", "[", "SCut", "]"}], "+", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"col", "=", 
       RowBox[{"\"\<w\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"Length", "[", "SCut", "]"}], "+", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"dirty", " ", "hack"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"statRow", "=", 
       RowBox[{"checkPrevious", "[", 
        RowBox[{"conn", ",", "dataset", ",", "fullN", ",", "SCut"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "statRow", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"P", ",", "C1"}], "}"}], "=", 
       RowBox[{"getSequenceStat", "[", 
        RowBox[{"statRow", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c1", ",", "c2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{"C1", "+", 
           RowBox[{"P", "*", 
            RowBox[{"First", "[", "v", "]"}]}]}], "]"}], ",", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"C1", "+", 
           RowBox[{"P", "*", 
            RowBox[{"Total", "[", "v", "]"}]}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"getSuperinterval", "[", 
        RowBox[{"conn", ",", "table", ",", "col", ",", "c1", ",", "c2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", "\[Equal]", "Null"}], ",", 
        RowBox[{"s", "=", 
         RowBox[{"getSubinterval", "[", 
          RowBox[{"conn", ",", "table", ",", "col", ",", "c1", ",", "c2"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", "\[Equal]", "Null"}], ",", 
        RowBox[{
        "Throw", "[", "\"\<Couldn't find a superinterval.\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"S", ",", "s"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "s"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ByuCocaPQuery", "[", 
     RowBox[{"host_", ",", "credentials_", ",", "dataset_", ",", "fullN_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "S"}], "}"}], ",", 
      RowBox[{"p", "[", 
       RowBox[{
        RowBox[{"genConnection", "[", 
         RowBox[{"host", ",", "credentials"}], "]"}], ",", "dataset", ",", 
        "fullN", ",", "s", ",", "S"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ByuCocaC1Query", "[", 
     RowBox[{"host_", ",", "credentials_", ",", "dataset_", ",", "fullN_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "S"}], "}"}], ",", 
      RowBox[{"c", "[", 
       RowBox[{
        RowBox[{"genConnection", "[", 
         RowBox[{"host", ",", "credentials"}], "]"}], ",", "dataset", ",", 
        "fullN", ",", "s", ",", "S", ",", "1"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ByuCocaC2Query", "[", 
     RowBox[{"host_", ",", "credentials_", ",", "dataset_", ",", "fullN_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "S"}], "}"}], ",", 
      RowBox[{"c", "[", 
       RowBox[{
        RowBox[{"genConnection", "[", 
         RowBox[{"host", ",", "credentials"}], "]"}], ",", "dataset", ",", 
        "fullN", ",", "s", ",", "S", ",", "2"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ByuCocaSuperintervalQuery", "[", 
     RowBox[{"host_", ",", "credentials_", ",", "dataset_", ",", "fullN_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "S"}], "}"}], ",", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{
        RowBox[{"genConnection", "[", 
         RowBox[{"host", ",", "credentials"}], "]"}], ",", "dataset", ",", 
        "fullN", ",", "v", ",", "S"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{866, 628},
WindowMargins->{{Automatic, 61}, {Automatic, 27}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 16, \
2013)",
StyleDefinitions->"Default.nb"
]

